"use strict";angular.module("dsfrontendApp.config",[]).constant("settings",{baseURL:"/api/v1/"}),angular.module("dsfrontendApp.login",[]).factory("authentication",["$location","$state","$cookieStore","authorization","api","settings","$cookies","SweetAlert","analytics","$rootScope","$q","$modal",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=function(a,c){var f=k.defer(),g={email:a,password:c},h=function(a){var c=a.token;e.init(c),v(a),b.go("index.missions"),i.shutdownAnalytics(),i.loadAnalytics(a),i.trackAnalyticsEvent("logged-in"),f.resolve(a)},j=function(a){f.reject(a)};return d.login(g).success(h).error(j),f.promise},n=function(a){var c=jstz.determine(),f=c.name(),g={timezone:f},j=function(c){var d=c.token;e.init(d),v(c),a?b.go("index.missions"):b.go(b.current,{},{reload:!0}),i.shutdownAnalytics(),i.loadAnalytics(c),i.trackAnalyticsEvent("guest-signup")},k=function(){h.swal("Couldn't start the missions","Either there is an internet connection problem or a server problem.","error")};d.guestSignup(g).success(j).error(k)},o=function(a){var b=x()&&w();return b?r(a,!1):r(a,!0)},p=function(a){var b=k.defer(),c=function(a){b.resolve(a)},e=function(a){b.reject(a)};return d.resetPassword(a).success(c).error(e),b.promise},q=function(a){var b=k.defer(),c=function(a){b.resolve(a)},e=function(a){b.reject(a)};return d.resetPasswordConfirm(a).success(c).error(e),b.promise},r=function(a,c){void 0==c&&(c=!1);var f=k.defer(),g=jstz.determine(),h=g.name(),j={email:a.email,password:a.password,name:a.name,timezone:h},l=function(a){var c=a.token;e.init(c),v(a),b.go("index.missions"),i.shutdownAnalytics(),i.loadAnalytics(a),i.trackAnalyticsEvent("signed-up"),f.resolve(a)},m=function(a){f.reject(a)};return c?d.signupFromScratch(j).success(l).error(m):d.signup(j).success(l).error(m),f.promise},s=function(){var a=function(a){var b=a.token;e.init(b),c.remove("token"),v(a),i.loadAnalytics(a)},b=function(){};d.refresh().success(a).error(b)},t=function(){e.init(void 0),c.remove("token"),b.go("index.main"),i.trackAnalyticsEvent("logged-out"),i.trackAnalyticsEvent("session-ended"),i.shutdownAnalytics()},u=function(){var a=c.get("token");return void 0==a?void 0:a},v=function(a){c.put("token",a)},w=function(){var a=u();return void 0==a?!1:!0},x=function(){var a=u();return void 0==a?!0:a.profile.is_guest},y=function(){var a=u();return void 0==a?!1:"premium"===a.profile.plan};j.$on("invalid-cookie-data",function(a,b){console.log("Invalid"),t()});var z=function(a){l.open({templateUrl:"views/authmodal.html",controller:"AuthModalCtrl",resolve:{type:function(){return a}}})},A=function(){z("login")},B=function(){z("signup")};return{login:m,signup:o,logout:t,getToken:u,setToken:v,refresh:s,loggedIn:w,guestSignup:n,isGuest:x,openLoginModal:A,openSignUpModal:B,hasPremium:y,resetPassword:p,resetPasswordConfirm:q}}]).factory("authorization",["$http","settings",function(a,b){var c=b.baseURL;return{login:function(b){return a.post(c+"accounts/get_auth_token/",b)},signup:function(b){return a.post(c+"accounts/create_user/",b)},signupFromScratch:function(b){return a.post(c+"accounts/create_user_from_scratch/",b)},refresh:function(){var b=c+"accounts/get_auth_token_data/";return a.get(b)},guestSignup:function(b){return a.post(c+"accounts/create_guest_user/",b)},resetPassword:function(b){return a.post(c+"accounts/reset_password/",b)},resetPasswordConfirm:function(b){return a.post(c+"accounts/reset_password_confirm/",b)}}}]).factory("analytics",["$http","settings","$rootScope","$window",function(a,b,c,d){var e=function(){try{return d.self!==d.top}catch(a){return!0}},f=e();return{isEmbedded:function(){return e()},loadAnalytics:function(a){try{window.analytics.load(a.segment_write_key)}catch(b){console.log("Couldn't start analytics")}try{1==a.profile.is_guest?(f||window.Intercom("boot",{app_id:a.intercom_app_id,created_at:a.date_joined_timestamp,user_hash:a.intercom_user_hash,user_id:a.intercom_id,plan:a.profile.plan}),window.analytics.identify(a.segment_write_key,{email:a.email,plan:a.profile.plan})):(f||window.Intercom("boot",{app_id:a.intercom_app_id,name:a.first_name+" "+a.last_name,email:a.email,created_at:a.date_joined_timestamp,user_hash:a.intercom_user_hash,user_id:a.intercom_id,plan:a.profile.plan}),window.analytics.identify(a.segment_write_key,{name:a.first_name+" "+a.last_name,email:a.email,plan:a.profile.plan}))}catch(b){console.log("Couldn't start analytics"),console.log(b),c.$emit("invalid-cookie-data")}},shutdownAnalytics:function(){try{window.Intercom("shutdown"),window.analytics.reset()}catch(a){console.log("Couldn't shutdown analytics")}},refreshAnalytics:function(){f||window.Intercom("update")},trackAnalyticsEvent:function(a,b){f||(void 0==b&&(b={}),window.Intercom("trackEvent",a,b),window.analytics.track(a,b))}}}]),angular.module("dsfrontendApp.api",[]).factory("api",["$http","$cookieStore","$q","settings","analytics","$location",function(a,b,c,d,e,f){var g=function(b){e.trackAnalyticsEvent("session-started"),void 0!=b?a.defaults.headers.common.Authorization="Token "+b:delete a.defaults.headers.common.Authorization},h=d.baseURL,i=function(b){var d=c.defer();return a.get(b).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject(a)}),d.promise},j=function(b,d){var e=c.defer();return a.post(b,d).success(function(a,b,c,d){e.resolve(a)}).error(function(a,b,c,d){e.reject(a)}),e.promise},k=function(b){var d=c.defer();return a["delete"](b).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject(a)}),d.promise},l=function(b,d){var e=c.defer();return a.get(b,d).success(function(a,b,c,d){e.resolve(a)}).error(function(a,b,c,d){e.reject(a)}),e.promise},m=function(a){var b=f.protocol(),c="http:",d="https:";return a.substring(0,c.length)===c?a=a.replace(c,b+":"):a.substring(0,d.length)===d&&(a=a.replace(d,b+":")),a},n=function(b,d){var e=c.defer();return a({method:"PATCH",url:b,data:d}).success(function(a,b,c,d){e.resolve(a)}).error(function(a,b,c,d){e.reject(a)}),e.promise};return{init:function(a){g(a)},missions:function(){var a=h+"missions/missions/";return i(a)},sections:function(){var a=h+"missions/sections/";return i(a)},mission:function(a){var b=h+"missions/missions/"+a+"/";return i(b)},nextScreen:function(a,b){var c=h+"missions/missions/"+a+"/next_screen/";return j(c,b)},goToScreen:function(a,b){var c=h+"missions/missions/"+a+"/go_to_screen/";return j(c,b)},restartMission:function(a){var b=h+"missions/missions/"+a+"/restart/";return j(b,{})},checkCode:function(a,b){return j(a+"run_code/",{code:b})},getURL:function(a){return i(a)},getURLWithConfig:function(a,b){return l(a,b)},goBack:function(a,b){var c=h+"missions/missions/"+a+"/go_back/";return j(c,{sequence:b})},runSandboxCode:function(a){return j(h+"missions/run_sandbox_code/",{code:a})},resetCode:function(a){return j(a+"reset_code/",{})},runInteractiveCode:function(a,b){return j(a+"interactive_mode/",{code:b})},getProtocolURL:function(a){var a=m(a);return i(a)},postURL:function(a,b){return j(a,b)},patchURL:function(a,b){return n(a,b)},postToken:function(a,b){var c=h+"accounts/change_subscription/";return j(c,{subscription_type:b,token:a})},createPost:function(a,b,c){var d=h+"forums/boards/"+c+"/new_post/";return j(d,{title:a,text:b})},getBoard:function(a,b){var c=h+"forums/boards/"+a+"/";return l(c,{params:{start_offset:b}})},votePost:function(a,b){var c=h+"forums/posts/"+a+"/vote/";return j(c,{score:b})},deletePost:function(a){var b=h+"forums/posts/"+a+"/";return k(b)},getPost:function(a){var b=h+"forums/posts/"+a+"/";return i(b)},createComment:function(a,b){var c=h+"forums/posts/"+b+"/new_comment/";return j(c,{text:a})},voteComment:function(a,b){var c=h+"forums/comments/"+a+"/vote/";return j(c,{score:b})},deleteComment:function(a){var b=h+"forums/comments/"+a+"/";return k(b)},updateComment:function(a,b){var c=h+"forums/comments/"+b+"/";return n(c,{text:a})},updatePost:function(a,b,c){var d=h+"forums/posts/"+c+"/";return n(d,{title:a,text:b})},getBoardList:function(){var a=h+"forums/boards/";return i(a)},updateBillingInfo:function(a){var b=h+"accounts/update_card/";return j(b,{token:a})},getSiteInfo:function(){var a=h+"accounts/site_info/";return i(a)},getMissionInfo:function(a){var b=h+"missions/mission_info/";return l(b,{params:{mission_number:a}})},getRepoInfo:function(){var a=h+"missions/github_repos/";return i(a)},linkRepo:function(a){var b=h+"missions/github_repos/";return j(b,a)},getMissionSources:function(){var a=h+"missions/mission_sources/";return i(a)},syncSource:function(a){var b=h+"missions/mission_sources/"+a+"/sync/";return j(b,{})},publishSource:function(a){var b=h+"missions/mission_sources/"+a+"/publish/";return j(b,{})},testSource:function(a){var b=h+"missions/mission_sources/"+a+"/test/";return j(b,{})},lessons:function(){var a=h+"missions/lessons/";return i(a)},voteLesson:function(a,b){var c=h+"missions/lessons/"+a+"/vote/";return j(c,{score:b})}}}]).factory("httpInterceptor",["$q","$window","$location",function(a,b,c){return function(b){var d=function(a){return a},e=function(b){return 401===b.status&&c.url("/"),a.reject(b)};return b.then(d,e)}}]),angular.module("dsfrontendApp.code",[]).factory("code",["$http","$cookieStore","$q","settings","analytics",function(a,b,c,d,e){var f=function(a,b){b.codeEditor.setValue(a.code,-1)},g=function(a,b){b.resultEditor.setValue(a.output,-1)},h=function(a){var b,c="",d=a.vars,e={},f=Object.keys(d);for(f.sort(),b=0;b<Object.keys(d).length;b++){var g=f[b],h=d[g],i="dq_plot";g.length>=i.length&&g.substring(0,i.length)===i?e[g.replace(i,"")]=h:c+=g+": "+h+"\n"}var j=Object.keys(e).sort(),k=[];for(b=0;b<j.length;b++)k.push(e[j[b]]);var l={plots:k,variablesString:c};return l},i=function(a,b){var c=h(a);b.plots=c.plots,b.currentPlot=c.plots.length-1,b.variableEditor.setValue(c.variablesString,-1)},j=function(a,b){if(b.plots.length>0){var c=b.plots[b.plots.length-1],d="<img alt='Plot' src="+c+" />";$("#plotsvg").html(d)}},k=function(a,b){f(a,b),g(a,b),i(a,b),j(a,b)},l=function(a){return!a instanceof Array?a:a.length>1?a[2]:a};return{addResultsAndCodeToEditor:k,resultsEditorLoaded:function(a,b,c){a.setReadOnly(!0),a.__defineGetter__("$readOnly",function(){return!0}),b.resultEditor=a,c&&g(b.currentScreen.initial_code_result,b)},getVariablesFromResponse:h,codeEditorChanged:function(a,b){var c=a[1];b.currentCode=c.getSession().getValue()},variablesEditorLoaded:function(a,b,c){a.setReadOnly(!0),a.__defineGetter__("$readOnly",function(){return!0}),b.variableEditor=a,c&&i(b.currentScreen.initial_code_result,b)},codeEditorLoaded:function(a,b,c){b.codeEditor=a,c&&f(b.currentScreen.initial_code_result,b)},getOriginalValues:function(a){var b={results:a.resultEditor.getSession().getValue(),variables:a.variableEditor.getSession().getValue()};return b},setupInteractiveMode:function(a){a.codeEditor.setReadOnly(!0)},cancelInteractiveMode:function(a){void 0!=a.codeEditor&&(a.codeEditor.getSession().clearBreakpoints(),a.codeEditor.setReadOnly(!1))},restoreOriginalValues:function(a,b){a.resultEditor.setValue(b.results,-1),a.variableEditor.setValue(b.variables,-1)},handleInteractiveStep:function(a,b){a.codeEditor.getSession().clearBreakpoints();var c=ace.require("ace/range").Range;a.codeEditor.getSession().selection.setRange(new c(b.line-1,0,b.line-1,1e3)),a.codeEditor.getSession().setBreakpoint(b.line-1);var d=b.stdout;void 0==b.stdout&&(d="");var e="";if(void 0!=b.ordered_globals)for(var f=0;f<b.ordered_globals.length;f++){var g=b.ordered_globals[f],h=l(b.globals[g]),i="dq_plot";g.length>=i.length&&g.substring(0,i.length)===i||(e+=g+": "+h+"\n")}"uncaught_exception"!=b.event||(d=d+"\n"+b.exception_msg),a.resultEditor.setValue(d),a.variableEditor.setValue(e)}}}]),angular.module("dsfrontendApp.forum",[]).factory("forum",["$http","$cookieStore","$q","$modal","api","analytics",function(a,b,c,d,e,f){var g=function(a){d.open({templateUrl:"views/forum/boardmodal.html",controller:"BoardModalCtrl",resolve:{boardID:function(){return a}}})},h=function(a){a.board={},e.getBoard(a.boardID).then(function(b){a.board=b,a.offset=b.offset,a.offsetQueries=[],a.boardComplete=!1,1==b.board_complete&&(a.boardComplete=!0)})},i=function(a,b){f.trackAnalyticsEvent("comment-vote"),e.voteComment(a.id,b).then(function(c){1==b?a.user_upvoted=!0:a.user_upvoted=!1,a.total_score=c.score})},j=function(a,b){f.trackAnalyticsEvent("comment-delete"),e.deleteComment(b.id).then(function(b){s(a,a.post.id)})},k=function(a,b){f.trackAnalyticsEvent("post-vote"),e.votePost(a.id,b).then(function(c){1==b?a.user_upvoted=!0:a.user_upvoted=!1,a.total_score=c.score})},l=function(a,b){f.trackAnalyticsEvent("post-delete"),e.deletePost(b.id).then(function(b){h(a)})},m=function(a){f.trackAnalyticsEvent("post-new"),e.createPost(a.postInfo.title,a.postInfo.text,a.boardID).then(function(b){a.board.posts.unshift(b),a.isNewPostOpen=!1,a.postInfo={title:"",text:""}})},n=function(a){f.trackAnalyticsEvent("comment-new"),e.createComment(a.commentInfo.text,a.post.id).then(function(b){a.post.comments.unshift(b),a.isNewCommentOpen=!1,a.commentInfo={text:""}})},o=function(a,b){f.trackAnalyticsEvent("comment-update"),e.updateComment(a.commentEditInfo.text,b.id).then(function(c){b.text=a.commentEditInfo.text,b.edit_mode=!1,a.commentEditInfo={text:""}})},p=function(a){f.trackAnalyticsEvent("post-update");var b=a.post;e.updatePost(a.postEditInfo.title,a.postEditInfo.text,b.id).then(function(c){b.text=a.postEditInfo.text,b.edit_mode=!1,a.postEditInfo={text:"",title:""}})},q=function(a,b){f.trackAnalyticsEvent("comment-edit"),a.isNewCommentOpen=!1,b.edit_mode=!0,a.commentEditInfo.text=b.text},r=function(a){f.trackAnalyticsEvent("post-edit");var b=a.post;b.edit_mode=!0,a.isNewPostOpen=!1,a.postEditInfo.text=b.text,a.postEditInfo.title=b.title},s=function(a,b){a.post=void 0,e.getPost(b).then(function(b){a.mode="post",a.post=b})},t=function(a){a.mode="board",h(a)},u=function(a){a.mode="boards",a.board={},a.boards=[],v(a)},v=function(a){e.getBoardList().then(function(b){a.boards=b})},w=function(a){var b=a.offset;-1==a.offsetQueries.indexOf(b)&&b>0&&(a.offsetQueries.push(b),e.getBoard(a.boardID,b).then(function(b){void 0!=a.board.posts&&(a.board.posts=a.board.posts.concat(b.posts)),a.offset=a.offset+b.offset,1==b.board_complete&&(a.boardComplete=!0)}))};return{openBoardModal:g,voteComment:i,deleteComment:j,votePost:k,deletePost:l,newPost:m,newComment:n,updateComment:o,updatePost:p,editComment:q,editPost:r,refreshPost:s,boardMode:t,getBoardsList:v,boardsMode:u,fetchPosts:w}}]),angular.module("dsfrontendApp.tasks",[]).factory("tasks",["$location","$state","$cookieStore","settings","poller",function(a,b,c,d,e){var f=[],g=function(a,b,c,g){var h=e.get(d.baseURL+"missions/task_status/",{action:"get",delay:1e3,smart:!0,argumentsArray:[{params:{task_type:a,task_id:b}}]}),i=function(a){var b=a.data;if(b.current==b.total){for(var c=b.task_id,d=void 0,e=0;e<f.length;e++)f[e].taskID==c&&(d=e);if(void 0!=d){var h=f.splice(d,1);h=h[0],h.stop(),g(h.object,b)}}};h.promise.then(null,null,i),h.taskID=b,h.object=c,f.push(h)};return{pollTask:g}}]),angular.module("dsfrontendApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","dsfrontendApp.config","dsfrontendApp.login","dsfrontendApp.api","dsfrontendApp.code","dsfrontendApp.forum","dsfrontendApp.tasks","youtube-embed","ui.ace","oitozero.ngSweetAlert","angular-ladda","angularSmoothscroll","ui.router","ui.bootstrap","ui.gravatar","angularSpinner","ngAudio","angulartics","angulartics.segment.io","angulartics.intercom","btford.markdown","cfp.hotkeys","infinite-scroll","emguo.poller","toaster","akoenig.deckgrid","ngIdle"]).config(["$locationProvider","$stateProvider","$urlRouterProvider","$httpProvider","$urlMatcherFactoryProvider","pollerConfig","KeepaliveProvider","IdleProvider",function(a,b,c,d,e,f,g,h){function i(a){return null!=a?a:a}function j(a){return null!=a?a:a}function k(a){return this.pattern.test(a)}h.idle(600),h.timeout(900),g.interval(3600),f.neverOverwrite=!0,c.deferIntercept(),d.defaults.headers.patch={"Content-Type":"application/json;charset=utf-8"},c.otherwise("/"),e.type("SlashType",{encode:i,decode:j,is:k,pattern:/[/]?/}),b.state("index",{templateUrl:"views/global_content.html","abstract":!0}).state("index.missions",{url:"/missions",templateUrl:"views/missions.html",controller:"MissionsCtrl"}).state("index.main",{url:"/",templateUrl:"views/main.html",controller:"MainCtrl"}).state("index.logout",{templateUrl:"views/logout.html",controller:"LogoutCtrl",url:"/logout"}).state("index.sandbox",{templateUrl:"/views/sandbox.html",controller:"SandboxCtrl",url:"/sandbox"}).state("index.boards",{templateUrl:"/views/forum/boards.html",controller:"BoardsCtrl",url:"/forum{slash1:SlashType}{boardID:[0-9]*}{slash2:SlashType}{postID:[0-9]*}"}).state("mission",{templateUrl:"/views/mission.html",controller:"MissionCtrl",url:"/mission/{sequence:[0-9]*}{slash1:SlashType}{screenString:[a-z]*}{slash2:SlashType}{screenSequence:[0-9]*}"}).state("index.settings",{templateUrl:"/views/settings.html","abstract":!0,controller:"SettingsCtrl"}).state("index.settings.basic_info",{templateUrl:"/views/settings/basic_info.html",controller:"BasicInfoCtrl",url:"/settings/basic_info"}).state("index.settings.plans",{templateUrl:"/views/settings/plans.html",controller:"PlansCtrl",url:"/settings/plans"}).state("index.settings.current_plan",{templateUrl:"/views/settings/current_plan.html",controller:"CurrentPlanCtrl",url:"/settings/current_plan"}).state("index.password_reset_confirm",{templateUrl:"/views/password_reset.html",controller:"PasswordResetCtrl",url:"/accounts/password_reset_confirm/:uid/:token"}).state("index.creator",{templateUrl:"/views/creator.html","abstract":!0,controller:"CreatorCtrl"}).state("index.creator.github_link",{templateUrl:"/views/creator/github_link.html",controller:"GithubLinkCtrl",url:"/creator/github_link"}).state("index.creator.clone_repo",{templateUrl:"/views/creator/clone_repo.html",controller:"CloneRepoCtrl",url:"/creator/clone_repo"}).state("index.creator.sync_missions",{templateUrl:"/views/creator/sync_missions.html",controller:"SyncMissionsCtrl",url:"/creator/sync_missions"}).state("index.lessons",{templateUrl:"/views/lessons.html",controller:"LessonsCtrl",url:"/lessons"}),a.html5Mode(!0)}]).run(["$rootScope","analytics","api","authentication","$cookieStore","$urlRouter","$location","$state","$window","Idle",function(a,b,c,d,e,f,g,h,i,j){j.watch(),a.previousState=void 0,a.currentState=void 0,a.$on("$locationChangeSuccess",function(a,b,c){a.preventDefault(),"mission"!==h.current.name&&f.sync()}),f.listen(),i.onbeforeunload=function(a){b.trackAnalyticsEvent("session-ended")},a.$on("IdleTimeout",function(){b.trackAnalyticsEvent("session-ended"),b.shutdownAnalytics()}),a.$on("IdleEnd",function(){k()}),a.$on("$stateChangeSuccess",function(c,d,e,f,g){b.refreshAnalytics(),a.previousState=f.name,a.currentState=d.name});var k=function(){var a=e.get("token");if(void 0!=a){var f=a.token;c.init(f),d.refresh()}else b.shutdownAnalytics()};k()}]),angular.module("infinite-scroll").value("THROTTLE_MILLISECONDS",300),angular.module("dsfrontendApp").controller("MainCtrl",["$scope","authentication",function(a,b){a.loggedIn=b.loggedIn(),a.radioModel="Signup",a.status={open:!0},a.oneAtATime=!0,$("body").addClass("main-screen"),a.getStarted=function(){b.guestSignup(!0)},a.loginModal=function(){b.openLoginModal()}}]),angular.module("dsfrontendApp").controller("HeaderCtrl",["$scope","$location","$cookieStore","authentication","$cookies","api","$rootScope","poller","settings","toaster",function(a,b,c,d,e,f,g,h,i,j){a.loggedOut=!0,a.email="",a.points=0,a.streak=0,a.hasPremium=d.hasPremium(),a.isGuest=!0,a.version=void 0;var k=function(b){var c=b.data.version;void 0!=a.version&&a.version!=c&&j.pop("warning","The server has been updated","Please reload the page as soon as you can.",0),a.version=c},l=h.get(i.baseURL+"accounts/site_info/",{delay:6e5,argumentsArray:[]});l.promise.then(null,null,k),g.$on("screen-gold-received",function(a,b){n()});var m=function(){var b="days";1==a.streak&&(b="day");var c="points";1==a.points&&(c="point"),a.streakText=a.streak+" "+b+" in a row writing code",a.pointsText=a.points+" "+c+" today"},n=function(){var b=d.getToken().url;void 0!=b&&f.getProtocolURL(b).then(function(b){a.points=b.profile.points,a.streak=b.profile.streak,m()})},o=d.getToken();void 0!=o&&(n(),a.loggedOut=!1,a.email=o.email,a.data=o,a.plan=o.profile.plan,a.isGuest=o.profile.is_guest),a.isActive=function(a){return a===b.path()},a.isForumActive=function(a){return b.path().substring(0,a.length)===a},a.$watch(function(){return e.token},function(b,c){if(void 0!=b?a.loggedOut=!1:a.loggedOut=!0,b!==c){var e=d.getToken();void 0!=e&&(a.email=e.email,a.data=e,a.plan=e.profile.plan,a.isGuest=d.isGuest(),a.hasPremium=d.hasPremium(),n())}}),a.loginModal=function(){d.openLoginModal()},a.signUpModal=function(){d.openSignUpModal()}}]),angular.module("dsfrontendApp").controller("MissionsCtrl",["$scope","api","$state","authentication","$cookies","SweetAlert",function(a,b,c,d,e,f){a.isGuest=d.isGuest(),a.loggedIn=d.loggedIn(),a.missions=[];var g=void 0;a.goToMission=function(b){for(var d,e=0;e<a.missions.length;e++)a.missions[e].sequence==b&&(d=a.missions[e]);d.premium&&"premium"!=a.plan?f.swal("This mission requires premium","Upgrade to premium to access this mission!","error"):c.go("mission",{sequence:b})},a.signUpModal=function(){d.openSignUpModal()},a.loginModal=function(){d.openLoginModal()};var h=function(){a.sectionsProcessed=!1,a.totalProgress=0;var c=new Date(0),d=!0;b.sections().then(function(b){a.sections=b.results,a.missions=[];for(var e=0;e<a.sections.length;e++)for(var f=a.sections[e],g=0;g<f.missions.length;g++){var h=f.missions[g];h.progress>h.total&&(h.progress=h.total);var i=h.progress/h.total,j=10*Math.round(h.progress/h.total*10);i>=1&&(i=1),1>i&&i>=0&&(i=0),0==h.unlocked&&(i=2),h.progress_switch=i,h.rounded_progress=j,a.totalProgress=a.totalProgress+h.progress,0==e&&0==g&&(a.introMission=h),1==e&&0==g&&(a.advancedIntroMission=h);var k=Date.parse(h.last_accessed);k>c&&h.progress_switch<1&&(c=k,a.currentMission=h,0!=j&&(d=!1)),a.missions.push(h)}if(d)for(var l=!1,e=0;e<a.sections.length;e++)for(var f=a.sections[e],g=0;g<f.missions.length;g++){var h=f.missions[g];h.progress_switch<1&&!l&&(l=!0,a.currentMission=h)}a.sectionsProcessed=!0})};a.loggedIn?(g=d.getToken(),a.plan=g.profile.plan,h()):d.guestSignup(!1),a.$watch(function(){return e.token},function(b,c){if(b!==c){var e=d.getToken();a.isGuest=d.isGuest(),a.plan=e.profile.plan,h()}})}]),angular.module("dsfrontendApp").controller("LogoutCtrl",["$scope","authentication",function(a,b){a.logout=function(){b.logout()}}]),angular.module("dsfrontendApp").controller("MissionCtrl",["$scope","api","$route","$stateParams","SweetAlert","$rootScope","code","$window","$timeout","ngAudio","analytics","$analytics","$location","authentication","$cookies","$modal","forum","hotkeys","$state","toaster",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=d.sequence,v=(d.screenSequence,55),w=0,x=v+w,y=f.previousState;a.missionMode=void 0,a.isGuest=n.isGuest(),a.premium=n.hasPremium(),a.loggedIn=n.loggedIn(),a.isEmbedded=k.isEmbedded(),a.sequence=u,a.signUpModal=function(){n.openSignUpModal()},a.goBack=function(){"index.missions"!=y&&"index.lessons"!=y&&(y="index.missions"),k.trackAnalyticsEvent("go-back-from-mission",{mission:u}),s.go(y,{},{location:"replace",inherit:!1})},$(window).resize(function(){a.$apply(function(){z()})});var z=function(){var b=h.innerHeight-x-30,c=(b-35)/2;$("body").addClass("mission-screen");h.innerWidth-400;if(h.innerWidth<992&&(c=100),!a.loggedIn){var d=Math.max($(".intro-section").height()+200,h.innerHeight-x+5);$(".overlay-layer").height(d)}};a.$on("$destroy",function(){$("body").removeClass("mission-screen")}),a.$watch(function(){return o.token},function(b,c){b!==c&&(a.isGuest=n.isGuest(),a.premium=n.hasPremium())}),a.getStarted=function(){n.guestSignup(!1)},void 0!=u&&u.length>0&&b.getMissionInfo(u).then(a.loggedIn?function(b){a.missionMode=b.mode}:function(b){a.mission=b,"singlescreen"==b.mode&&n.guestSignup(!1),i(z,500),z()})}]),angular.module("dsfrontendApp").controller("SandboxCtrl",["$scope","api","$route","$stateParams","SweetAlert","$rootScope","code",function(a,b,c,d,e,f,g){a.currentCode="",a.codeAdded=!1,a.resultsAdded=!1,a.codeEditor=void 0,a.resultEditor=void 0,a.runLoading=!1;var h=function(b){g.resultsEditorLoaded(b,a,!1)},i=function(b){g.codeEditorChanged(b,a)},j=function(b){g.codeEditorLoaded(b,a,!1)};a.resultsEditorOptions={useWrapMode:!0,mode:"python",firstLineNumber:1,onLoad:h},a.codeEditorOptions={useWrapMode:!0,showGutter:!0,mode:"python",firstLineNumber:1,onLoad:j,onChange:i},a.runCode=function(){var c=a.currentCode;a.runLoading=!0,b.runSandboxCode(c).then(function(b){a.runLoading=!1;var c=b.result;g.addResultsAndCodeToEditor(c,a)},function(b){a.runLoading=!1})}}]),angular.module("dsfrontendApp").controller("BodyCtrl",["$scope","$location",function(a,b){a.isActive=function(a){return a===b.path()}}]),angular.module("dsfrontendApp").controller("SettingsCtrl",["$scope","$location",function(a,b){a.isActive=function(a){return a===b.path()}}]),angular.module("dsfrontendApp").controller("BasicInfoCtrl",["$scope","$location","$cookieStore","authentication","$cookies","api",function(a,b,c,d,e,f){a.infoSaving=!1;var g=d.getToken(),h=function(){a.userInfo={name:g.first_name+" "+g.last_name,email:g.email}};a.saveInfo=function(){a.infoSaving=!0;var b=a.userInfo.name.split(" "),c=b[0],e="";b.length>0&&(e=b.slice(1).join(" ")),f.patchURL(g.url,{first_name:c,last_name:e,email:a.userInfo.email}).then(function(b){d.refresh(),a.infoSaving=!1,h()},function(){a.infoSaving=!1,h()})},h()}]),angular.module("dsfrontendApp").controller("PlansCtrl",["$scope","$location","$cookieStore","authentication","$cookies","api","$rootScope","SweetAlert","analytics",function(a,b,c,d,e,f,g,h,i){var j=d.getToken(),k=function(){j=d.getToken(),a.plan=j.profile.plan},l=function(b,c){var e="Free",f="error";"premium"==c&&(e="Premium");var g="Failed to switch to the";void 0==b.error&&(g="Successfully switched to the",f="success"),h.swal(g+" "+e+" Plan",b.message,f),d.refresh(),"premium"==c&&(a.plan=c),i.refreshAnalytics()},m=function(a){f.postToken(a,"premium").then(function(a){i.trackAnalyticsEvent("premium-signup"),l(a,"premium")})};a.stripeHandler=StripeCheckout.configure({key:j.stripe_publishable_key,image:"https://stripe.com/img/documentation/checkout/marketplace.png",name:"DataQuest Premium",description:"$35 a month after 14 day free trial",panelLabel:"Subscribe",allowRememberMe:!1,email:j.email,token:m}),a.switchToFree=function(){f.postToken({},"free").then(function(a){i.trackAnalyticsEvent("premium-cancel"),l(a,"free")})},k()}]),angular.module("dsfrontendApp").controller("CurrentPlanCtrl",["$scope","$location","$cookieStore","authentication","$cookies","api","SweetAlert",function(a,b,c,d,e,f,g){var h=function(){var b=d.getToken();if(a.tokenData=b,a.invoicesActive=b.profile.premium_invoices_active,"premium"==b.profile.plan){a.currentPlan="Premium";var c=new Date(b.profile.premium_end_date),e=c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate();a.currentPlanExpiration=e}else"free"==b.profile.plan&&(a.currentPlan="Free",a.currentPlanExpiration="Never!");a.stripeHandler=StripeCheckout.configure({key:b.stripe_publishable_key,image:"https://stripe.com/img/documentation/checkout/marketplace.png",name:"DataQuest Premium",description:"$35 a month",panelLabel:"Update Info",allowRememberMe:!1,email:b.email,token:i})};a.cancelPremium=function(){g.swal({title:"Are you sure?",text:"You'll lose access to premium after the current month.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"I'm sure",closeOnCancel:!0},function(){f.postToken({},"free").then(function(a){analytics.trackAnalyticsEvent("premium-cancel"),g.swal("Successfully cancelled premium!","We're sorry to see you go.","success"),d.refresh(),h()})})};var i=function(a){analytics.trackAnalyticsEvent("update-billing-info"),f.updateBillingInfo(a).then(function(a){var b="Failed to update",c="error";void 0==a.error&&(b="Successfully updated",c="success"),g.swal(b+" your card information",a.message,c)})};h()}]),angular.module("dsfrontendApp").controller("AuthModalCtrl",["$scope","authentication","$modalInstance","$location","type",function(a,b,c,d,e){a.type=e,a.userInfo={email:"",password:"",name:""},a.errorText="",a.cancel=function(){c.dismiss("cancel")},a.login=function(){b.login(a.userInfo.email,a.userInfo.password).then(function(a){c.dismiss("cancel")},function(b){a.errorText="Couldn't log you in.  Please double check your username and passsword."})},a.switchToSignUp=function(){a.type="signup",a.errorText=""},a.switchToReset=function(){a.type="reset",a.errorText=""},a.signUp=function(){""==a.userInfo.name||""==a.userInfo.email||""==a.userInfo.password?a.errorText="Please fill out all of the fields.":b.signup(a.userInfo).then(function(a){c.dismiss("cancel")},function(b){a.errorText="An account with that email already exists.  Please try again, or login if you have an account."})},a.switchToLogin=function(){a.type="login",a.errorText=""},a.resetPassword=function(){""==a.userInfo.email?a.errorText="Please enter your email.":b.resetPassword(a.userInfo).then(function(b){a.errorText="An email has been sent to you.  Click the link in the email to reset your password."},function(b){a.errorText="We couldn't find an account with that email address."})}}]),angular.module("dsfrontendApp").controller("PlotZoomCtrl",["$scope","$modalInstance","$timeout","svg",function(a,b,c,d){a.svg=d,a.cancel=function(){b.dismiss("cancel")};var e=function(){var b=a.svg,c="<img alt='Plot' src="+b+" />";$("#plotsvgzoom").html(c)};c(e,50)}]),angular.module("dsfrontendApp").controller("PasswordResetCtrl",["$scope","authentication","$stateParams",function(a,b,c){var d=c.uid,e=c.token;a.userInfo={password:"",uid:d,token:e},a.errorText="",a.resetPasswordConfirm=function(){""==a.userInfo.password?a.errorText="Please enter a new password.":b.resetPasswordConfirm(a.userInfo).then(function(b){a.errorText="Your password has been reset!  Try logging in with your new password."},function(b){a.errorText="We couldn't validate your reset request -- you may have followed an invalid link."})}}]),angular.module("dsfrontendApp").controller("BoardModalCtrl",["$scope","$location","$modalInstance","authentication","api","forum","boardID",function(a,b,c,d,e,f,g){a.board={};var h=d.getToken();a.userID=h.id,a.isNewPostOpen=!1,a.isNewCommentOpen=!1,a.errorText="",a.mode="board",a.post=void 0,a.boardID=g,a.offset=0,a.boardComplete=!1,a.inModal=!0,a.infiniteScrollContainer=".modal",a.offsetQueries=[],a.errorText="",a.postInfo={title:"",text:""},a.commentInfo={text:""},a.commentEditInfo={text:""},a.postEditInfo={text:"",title:""},a.cancel=function(){c.dismiss("cancel")},a.voteComment=function(b,c){var d=a.post.comments[b];f.voteComment(d,c)},a.deleteComment=function(b){var c=a.post.comments[b];f.deleteComment(a,c)},a.votePost=function(b,c){var d=a.board.posts[b];f.votePost(d,c)},a.singleVotePost=function(b){var c=a.post;f.votePost(c,b)},a.deletePost=function(b){var c=a.board.posts[b];f.deletePost(a,c)},a.newPost=function(){f.newPost(a)},a.newComment=function(){f.newComment(a)},a.updateComment=function(b){var c=a.post.comments[b];f.updateComment(a,c)},a.updatePost=function(b){f.updatePost(a)},a.editComment=function(b){var c=a.post.comments[b];f.editComment(a,c)},a.editPost=function(){f.editPost(a)},a.viewPost=function(b){var c=a.board.posts[b];f.refreshPost(a,c.id)},a.boardMode=function(){f.boardMode(a)},a.fetchPosts=function(){f.fetchPosts(a)},f.boardMode(a)}]),angular.module("dsfrontendApp").controller("BoardsCtrl",["$scope","$state","$stateParams","api","authentication","forum","analytics",function(a,b,c,d,e,f,g){a.board={};var h=e.getToken();a.userID=h.id,a.isNewPostOpen=!1,a.isNewCommentOpen=!1,a.errorText="",a.mode="boards",a.post=void 0,a.boardID=void 0,a.offset=0,a.boardComplete=!1,
a.inModal=!1,a.infiniteScrollContainer="",a.offsetQueries=[],a.errorText="",a.postInfo={title:"",text:""},a.commentInfo={text:""},a.commentEditInfo={text:""},a.postEditInfo={text:"",title:""};var i=function(a){b.transitionTo("index.boards",a,{location:!0,inherit:!0,relative:b.$current,notify:!1})};a.voteComment=function(b,c){var d=a.post.comments[b];f.voteComment(d,c)},a.deleteComment=function(b){var c=a.post.comments[b];f.deleteComment(a,c)},a.votePost=function(b,c){var d=a.board.posts[b];f.votePost(d,c)},a.singleVotePost=function(b){var c=a.post;f.votePost(c,b)},a.deletePost=function(b){var c=a.board.posts[b];f.deletePost(a,c)},a.newPost=function(){f.newPost(a)},a.newComment=function(){f.newComment(a)},a.updateComment=function(b){var c=a.post.comments[b];f.updateComment(a,c)},a.updatePost=function(b){f.updatePost(a)},a.editComment=function(b){var c=a.post.comments[b];f.editComment(a,c)},a.editPost=function(){f.editPost(a)},a.viewPost=function(b){var c=a.board.posts[b];i({slash1:"/",boardID:a.boardID,slash2:"/",postID:c.id}),f.refreshPost(a,c.id)},a.boardMode=function(){i({slash1:"/",boardID:a.boardID,slash2:void 0,postID:void 0}),f.boardMode(a)},a.boardsMode=function(){i({slash1:void 0,boardID:void 0,slash2:void 0,postID:void 0}),f.boardsMode(a)},a.viewBoard=function(b){var c=a.boards[b];a.boardID=c.id,a.boardMode()},a.fetchPosts=function(){f.fetchPosts(a)};var j=c.boardID,k=c.postID;0==j.length&&(j=void 0),0==k.length&&(k=void 0),void 0==j&&void 0==k?f.getBoardsList(a):void 0==k?(a.boardID=j,f.boardMode(a)):(a.boardID=j,a.mode="board",a.board={},d.getBoard(a.boardID).then(function(b){a.board=b,f.refreshPost(a,k)}))}]),angular.module("dsfrontendApp").controller("CreatorCtrl",["$scope","$location","authentication",function(a,b,c){a.isActive=function(a){return a===b.path()},a.isGuest=c.isGuest()}]),angular.module("dsfrontendApp").controller("GithubLinkCtrl",["$scope","$location","$cookieStore","authentication","$cookies","api",function(a,b,c,d,e,f){a.infoSaving=!1;var g=d.getToken();a.githubLinked=!1,a.githubName="",a.githubRepos=void 0;var h=function(){f.getRepoInfo().then(function(b){a.githubRepos=b.repos,a.githubName=b.name,a.githubLinked=!0},function(){})};a.handlePopupAuthentication=function(){a.$apply(function(){a.handleToken()})},a.handleToken=function(){console.log("Token received"),h()},a.openGithubWindow=function(){var b=g.host_protocol+g.hostname+"/api/v1/accounts/github_oauth/?token="+g.token;window.$windowScope=a,window.open(b,"Link Github","width=500, height=500")},a.linkRepo=function(b){var c=a.githubRepos[b];f.linkRepo(c).then(function(){h()})},h()}]),angular.module("dsfrontendApp").controller("CloneRepoCtrl",["$scope","$location","$cookieStore","authentication","$cookies","api",function(a,b,c,d,e,f){}]),angular.module("dsfrontendApp").controller("SyncMissionsCtrl",["$scope","$location","$cookieStore","authentication","$cookies","api","poller","settings","$modal","SweetAlert","$state","$window",function(a,b,c,d,e,f,g,h,i,j,k,l){a.missionSources=[];var m=[],n=function(a){var b=a.data;if(b.current==b.total){for(var c=b.task_id,d=void 0,e=0;e<m.length;e++)m[e].taskID==c&&(d=e);if(void 0!=d){var f=m.splice(d,1);f=f[0],"syncing"==f.propName?f.source.syncing=!1:"testing"==f.propName?f.source.testing=!1:"publishing"==f.propName&&(f.source.publishing=!1),f.stop();i.open({templateUrl:"views/creator/sync_info_modal.html",controller:"SyncInfoModalCtrl",resolve:{data:function(){return b},source:function(){return f.source},propName:function(){return f.propName}}});p()}}},o=function(a,b,c,d){var e=g.get(h.baseURL+"missions/task_status/",{action:"get",delay:15e3,argumentsArray:[{params:{task_type:a,task_id:b}}]});e.promise.then(null,null,n),e.taskID=b,e.source=c,e.propName=d,m.push(e)};a.syncSource=function(b){var c=a.missionSources[b];c.syncing=!0,f.syncSource(c.id).then(function(a){var b=a.task_type,d=a.task_id;o(b,d,c,"syncing")})},a.testSource=function(b){var c=a.missionSources[b];c.testing=!0,f.testSource(c.id).then(function(a){var b=a.task_type,d=a.task_id;o(b,d,c,"testing")})},a.publishSource=function(b){j.swal({title:"Are you sure?",text:"Once you publish, anyone will be able to see your mission.  Make sure you run the tests and look through the output to verify that there are no errors first.  Also make sure you go through the draft and make sure everything works properly.",type:"warning",showCancelButton:!0,confirmButtonText:"Go ahead and publish"},function(){var c=a.missionSources[b];c.publishing=!0,f.publishSource(c.id).then(function(a){var b=a.task_type,d=a.task_id;o(b,d,c,"publishing")})})},a.getEmbedCode=function(b,c){var d=a.missionSources[b].missions[c];if(void 0==d.published_mission||null==d.published_mission)j.swal("This mission isn't published yet","Hit publish before trying to generate embed code.","error");else{var e=d.published_mission;i.open({templateUrl:"views/creator/embed_modal.html",controller:"EmbedModalCtrl",resolve:{lesson:function(){return e}}})}},a.goToDraft=function(b,c){var d=a.missionSources[b].missions[c],e=k.href("mission",{sequence:d.sequence},{absolute:!0});l.open(e,"_blank")},a.goToPublished=function(b,c){var d=a.missionSources[b].missions[c];if(void 0==d.published_mission||null==d.published_mission)j.swal("This mission isn't published yet","Hit publish before trying to view this live.","error");else{var e=k.href("mission",{sequence:d.published_mission.sequence},{absolute:!0});l.open(e,"_blank")}};var p=function(){f.getMissionSources().then(function(b){a.missionSources=b;for(var c=0;c<a.missionSources.length;c++)a.missionSources[c].syncing=!1,a.missionSources[c].testing=!1,a.missionSources[c].publishing=!1})};p()}]),angular.module("dsfrontendApp").controller("SyncInfoModalCtrl",["$scope","authentication","$modalInstance","$location","data","source","propName",function(a,b,c,d,e,f,g){a.data=e,a.source=f,a.propName=g,a.cancel=function(){c.dismiss("cancel")}}]),angular.module("dsfrontendApp").controller("EmbedModalCtrl",["$scope","authentication","$modalInstance","$location","lesson",function(a,b,c,d,e){a.lesson=e,a.cancel=function(){c.dismiss("cancel")}}]),angular.module("dsfrontendApp").controller("LessonsCtrl",["$scope","api","$state","authentication","$cookies","SweetAlert","$modal",function(a,b,c,d,e,f,g){a.isGuest=d.isGuest(),a.loggedIn=d.loggedIn();var h=void 0;a.lessons=[],a.goToMission=function(b){for(var d,e=0;e<a.lessons.length;e++)a.lessons[e].sequence==b&&(d=a.lessons[e]);d.premium&&"premium"!=a.plan?f.swal("This mission requires premium","Upgrade to premium to access this mission!","error"):c.go("mission",{sequence:b})};var i=function(){a.lessonsProcessed=!1,a.totalProgress=0,b.lessons().then(function(b){var c=b;a.lessons=[];for(var d=0;d<c.length;d++){var e=c[d];e.progress>e.total&&(e.progress=e.total),e.rounded_progress=10*Math.round(e.progress/e.total*10),a.lessons.push(e)}a.lessonsProcessed=!0})},j=function(b){for(var c=void 0,d=0;d<a.lessons.length;d++)a.lessons[d].sequence==b&&(c=a.lessons[d]);return c};a.singleVoteLesson=function(a,c){var d=j(a);b.voteLesson(d.id,c).then(function(a){1==c?d.user_upvoted=!0:d.user_upvoted=!1,d.total_score=a.score})},a.showEmbedCode=function(a){var b=j(a);g.open({templateUrl:"views/creator/embed_modal.html",controller:"EmbedModalCtrl",resolve:{lesson:function(){return b}}})},a.loggedIn?(h=d.getToken(),a.plan=h.profile.plan,i()):d.guestSignup(!1),a.$watch(function(){return e.token},function(b,c){if(b!==c){var e=d.getToken();a.isGuest=d.isGuest(),a.plan=e.profile.plan,i()}})}]),angular.module("dsfrontendApp").controller("MultiScreenMissionCtrl",["$scope","api","$route","$stateParams","SweetAlert","$rootScope","code","$window","$timeout","ngAudio","analytics","$analytics","$location","authentication","$cookies","$modal","forum","hotkeys","$state","toaster","tasks",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=d.sequence,w=d.screenSequence,x=55,y=0,z=x+y;a.currentCode="",a.codeEditor=void 0,a.resultEditor=void 0,a.variableEditor=void 0,a.runLoading=!1,a.nextLoading=!1,a.videoHeight=600,a.videoWidth=300,a.resetLoading=!1,a.interactiveModeLoading=!1,a.interactiveModeEnabled=!1,a.interactiveIndex=0,a.isEmbedded=k.isEmbedded(),a.activeVariablePanel="variables",a.plots=[],a.currentPlot=0,a.runCount=0,a.showNextMessage=!0,a.currentScreen={type:"loading"},a.playerVars={controls:1,autoplay:0,modestbranding:1,showinfo:0,rel:0};$(window).resize(function(){a.$apply(function(){a.isEmbedded||B()})});var A=function(){var b=a.plots[a.currentPlot],c="<img alt='Plot' src="+b+" />";$("#plotsvg").html(c),B()};a.changeCurrentPlot=function(b){a.currentPlot=a.currentPlot+b,a.currentPlot<0&&(a.currentPlot=0),a.currentPlot>=a.plots.length&&(a.currentPlot=a.plots.length-1),i(A,10)},a.plotZoom=function(){p.open({templateUrl:"views/plotzoom.html",controller:"PlotZoomCtrl",size:"lg",resolve:{svg:function(){return a.plots[a.currentPlot]}}})},a.switchVariablePanel=function(b){a.activeVariablePanel=b,i(A,50)};var B=function(){var a=h.innerHeight-z-30,b=a-40,c=(a-35)/2,d=a+33,e=a-30;$(".loading").height(a),$("body").addClass("mission-screen");var f=d+2;h.innerWidth-400;h.innerWidth<992&&(e=$("#instructions-title").height()+$("#instructions-text").height()+30,d=e+33,c=100,b=300,f=d+2*c+b+2),$(".instructions").height(d),$(".instructions-panel").height(e),$(".code-panel-instructions").height(d),$("mission-code-container").height(f),$(".mission-body").height(f),$(".code-outer").height(f),$(".text-outer").height(b);var g=$(".variables .plot-container");$(".console .ace_editor").height(c),$(".variables .ace_editor").height(c),g.height(c),$(".code .ace_editor").height(b);var i=$(".plot-container img");i.height(c),i.width(g.width())},C=function(b){g.variablesEditorLoaded(b,a,!0),B()},D=function(b){g.resultsEditorLoaded(b,a,!0)},E=function(b){g.codeEditorChanged(b,a)},F=function(b){g.codeEditorLoaded(b,a,!0),B()};a.resultsEditorOptions={useWrapMode:!0,mode:"text",firstLineNumber:1,onLoad:D,showGutter:!1,theme:"tomorrow_night"},a.variablesEditorOptions={useWrapMode:!0,mode:"text",firstLineNumber:1,onLoad:C,showGutter:!1,theme:"tomorrow_night"},a.codeEditorOptions={useWrapMode:!0,showGutter:!0,mode:"python",firstLineNumber:1,onLoad:F,onChange:E,theme:"tomorrow_night"};var G=function(b){void 0==b?a.currentScreen={type:"end"}:(a.currentScreen=b,a.mission.progress=a.currentScreen.sequence),K()},H=function(c){a.nextLoading=!0;var d={sequence:c};b.goToScreen(a.mission.sequence,d).then(function(b){a.nextLoading=!1,G(b)},function(b){a.nextLoading=!1})},I=function(b){for(var c=0;c<a.mission.screens.length;c++){var d=a.mission.screens[c];d.sequence==b&&(d.complete=!0)}},J=function(){a.nextLoading=!0;var c=a.currentScreen.sequence,d={sequence:c};b.nextScreen(a.mission.sequence,d).then(function(b){k.trackAnalyticsEvent("finished-screen",{mission:a.mission.sequence,sequence:c,type:a.currentScreen.type}),a.nextLoading=!1,G(b),I(c)},function(b){a.nextLoading=!1})},K=function(){a.runCount=0,k.trackAnalyticsEvent("started-screen",{mission:a.mission.sequence,sequence:a.currentScreen.sequence,type:a.currentScreen.type}),k.refreshAnalytics(),l.pageTrack("/missions/"+a.mission.sequence+"/screen/"+a.currentScreen.sequence,m),a.currentScreen.codeSuccess=void 0,a.showNextMessage=!0,void 0!=a.currentScreen.initial_code_result&&1==a.currentScreen.initial_code_result.check&&(a.currentScreen.codeSuccess=!0,a.showNextMessage=!1),a.interactiveModeEnabled=!1,g.cancelInteractiveMode(a),void 0!=a.currentScreen.sequence&&("end"!=a.currentScreen.type?m.path("mission/"+a.mission.sequence+"/screen/"+a.currentScreen.sequence).replace():m.path("mission/"+a.mission.sequence).replace()),void 0!=a.codeEditor&&"code"==a.currentScreen.type&&g.addResultsAndCodeToEditor(a.currentScreen.initial_code_result,a),B()};a.switchScreen=function(a){H(a+1)},a.nextScreen=function(){k.trackAnalyticsEvent("next-screen",{mission:v,sequence:a.currentScreen.sequence}),J(a.currentScreen.sequence+1)};var L=function(b,c){var d=c.result.output,e=c.result.state;if("FAILURE"==e)a.runLoading=!1;else{a.runLoading=!1,a.runCount=a.runCount+1;var h=d.check;a.currentScreen.initial_code_result=d,g.addResultsAndCodeToEditor(d,a),B(),h?(a.currentScreen.codeSuccess=!0,f.$emit("screen-gold-received"),a.correct.play()):(a.currentScreen.codeSuccess=!1,a.incorrect.play(),void 0!=d.hint&&d.hint.length>0?a.currentScreen.answerHint=d.hint:a.currentScreen.answerHint=void 0)}},M=function(b,c){var d=c.result.output,e=c.result.state;"FAILURE"==e?a.interactiveModeLoading=!1:(a.interactiveModeLoading=!1,a.interactiveModeEnabled=!0,a.originalData=g.getOriginalValues(a),g.setupInteractiveMode(a),a.trace=d.trace,a.interactiveIndex=0,g.handleInteractiveStep(a,a.trace[a.interactiveIndex]))};a.runCode=function(){var c=a.codeEditor.getSession().getValue();a.runLoading=!0,a.correct=j.load("sounds/correct.mp3"),a.incorrect=j.load("sounds/incorrect.mp3"),k.trackAnalyticsEvent("run-code",{mission:v,sequence:a.currentScreen.sequence}),b.checkCode(a.currentScreen.url,c).then(function(b){var c=b.task_type,d=b.task_id;u.pollTask(c,d,a.currentScreen,L)},function(b){a.runLoading=!1})},a.interactiveMode=function(){var c=a.codeEditor.getSession().getValue();a.interactiveModeLoading=!0,k.trackAnalyticsEvent("interactive-mode-start",{mission:v,sequence:a.currentScreen.sequence}),b.runInteractiveCode(a.currentScreen.url,c).then(function(b){var c=b.task_type,d=b.task_id;u.pollTask(c,d,a.currentScreen,M)},function(b){a.interactiveModeLoading=!1})},a.interactiveModeEvent=function(b){-2==b?a.interactiveIndex=0:-1==b?a.interactiveIndex-=1:1==b?a.interactiveIndex+=1:2==b&&(a.interactiveIndex=a.trace.length-1),a.interactiveIndex>=a.trace.length&&(a.interactiveIndex=a.trace.length-1),a.interactiveIndex<0&&(a.interactiveIndex=0),g.handleInteractiveStep(a,a.trace[a.interactiveIndex])},a.cancelInteractiveMode=function(){a.interactiveModeEnabled=!1,g.cancelInteractiveMode(a),g.restoreOriginalValues(a,a.originalData),k.trackAnalyticsEvent("interactive-mode-end",{mission:v,sequence:a.currentScreen.sequence})},a.resetCode=function(){a.resetLoading=!0,k.trackAnalyticsEvent("reset-code",{mission:v,sequence:a.currentScreen.sequence}),b.resetCode(a.currentScreen.url).then(function(b){a.resetLoading=!1,a.currentScreen.initial_code_result=b,g.addResultsAndCodeToEditor(b,a)},function(b){a.resetLoading=!1})},a.showBoard=function(){var b=a.mission.board_id;k.trackAnalyticsEvent("open-forum",{mission:v,sequence:a.currentScreen.sequence}),q.openBoardModal(b)},a.nextMission=function(){var b=a.currentScreen.next_mission;k.trackAnalyticsEvent("go-to-next-mission",{mission:v,sequence:a.currentScreen.sequence}),!b.premium||a.premium?s.go("mission",{sequence:b.sequence}):e.swal("This mission requires premium","Upgrade to premium to access this mission!","error")};var N=function(){b.mission(v).then(function(b){a.mission=b,k.trackAnalyticsEvent("started-mission",{sequence:a.mission.sequence}),a.currentScreen=b.current_screen,a.mission.progress=a.currentScreen.sequence,a.mission.progress>a.mission.total&&(a.mission.progress=a.mission.total),void 0==w||w.length<1?K():H(w)},function(a){t.pop("error","Error loading mission",a.error,0)})};N(),a.$on("youtube.player.ended",function(b,c){k.trackAnalyticsEvent("video-ended",{mission:v,sequence:a.currentScreen.sequence})}),a.$on("youtube.player.ready",function(b,c){k.trackAnalyticsEvent("video-ready",{mission:v,sequence:a.currentScreen.sequence})}),a.$on("youtube.player.playing",function(b,c){k.trackAnalyticsEvent("video-playing",{mission:v,sequence:a.currentScreen.sequence})}),a.$on("youtube.player.paused",function(b,c){k.trackAnalyticsEvent("video-paused",{mission:v,sequence:a.currentScreen.sequence})}),a.$on("youtube.player.error",function(b,c){k.trackAnalyticsEvent("video-error",{mission:v,sequence:a.currentScreen.sequence})}),r.bindTo(a).add({combo:"ctrl+alt+r",description:"Run the current code",callback:function(){a.runCode()},allowIn:["TEXTAREA"]}).add({combo:"ctrl+alt+d",description:"Switch to debug mode",callback:function(){a.interactiveMode()},allowIn:["TEXTAREA"]}).add({combo:"ctrl+alt+p",description:"Move to the next screen",callback:function(){a.nextScreen()},allowIn:["TEXTAREA"]}).add({combo:"ctrl+alt+f",description:"Show the forum",callback:function(){a.showBoard()},allowIn:["TEXTAREA"]})}]),angular.module("dsfrontendApp").controller("SingleScreenMissionCtrl",["$scope","api","$route","$stateParams","SweetAlert","$rootScope","code","$window","$timeout","ngAudio","analytics","$analytics","$location","authentication","$cookies","$modal","forum","hotkeys","$state","toaster","tasks",function(a,b,c,d,e,f,g,h,j,k,l,m,n,o,p,q,r,s,t,u,v){var w=d.sequence;d.screenSequence;a.currentCode="",a.codeEditor=void 0,a.resultEditor=void 0,a.variableEditor=void 0,a.runLoading=!1,a.nextLoading=!1,a.videoHeight="400px",a.videoWidth="100%",a.resetLoading=!1,a.interactiveModeLoading=!1,a.interactiveModeEnabled=!1,a.interactiveIndex=0,a.isEmbedded=l.isEmbedded(),a.activeVariablePanel="variables",a.plots=[],a.currentPlot=0,a.showNextMessage=!0,a.timeoutSet=!1,a.loadCount=0,a.currentSequence=1,a.showEndMessage=!1,a.currentScreen={type:"loading"},a.playerVars={controls:1,autoplay:0,modestbranding:1,showinfo:0,rel:0};$(window).resize(function(){a.$apply(function(){for(var b=0;b<a.currentScreen.length;b++){var c=a.currentScreen[b].editor;void 0!=c&&x(c)}})});var x=function(a){var b=(a.getSession().getScreenLength()+1)*a.renderer.lineHeight+a.renderer.scrollBar.getWidth();$("#"+a.screen_id).height(b.toString()+"px"),a.resize()},y=function(a){var b=a[1];x(b)},z=function(){for(var b=0;b<a.currentScreen.length;b++){var c=a.currentScreen[b];try{c.editor=ace.edit(a.editorClass(c)),c.editorShown=!0}catch(d){c.editorShown=!1}}for(var b=0;b<a.currentScreen.length;b++){var c=a.currentScreen[b];1!=c.editorSetup&&1==c.editorShown&&(c.editorSetup=!0,c.editor=ace.edit(a.editorClass(c)),c.editor.setValue(c.initial_code_result.code,-1),c.editor.screen_id=a.editorClass(c),c.editor.setFontSize("14px"),x(c.editor))}a.loadCount+=1,a.loadCount<3&&(a.timeoutSet=!1,A(""))},A=function(a){j(z,500)};a.codeEditorOptions={useWrapMode:!0,showGutter:!0,mode:"python",firstLineNumber:1,theme:"tomorrow",maxLines:1e4,onLoad:A,onChange:y};var B=function(b){for(var c=0;c<a.currentScreen.length;c++)if(a.currentScreen[c].sequence==b)return a.currentScreen[c];return void 0},C=function(b){var c=b.sequence;l.trackAnalyticsEvent("finished-screen",{mission:a.mission.sequence,sequence:c,type:b.type}),a.currentSequence+=1,b=B(a.currentSequence),void 0!=b?a.setActive(b):a.showEndMessage=!0};a.nextScreen=function(b){l.trackAnalyticsEvent("next-screen",{mission:w,sequence:a.currentScreen[i].sequence}),C(b)};var D=function(b,c){var d=c.result.output,e=c.result.state;if("FAILURE"==e)b.runLoading=!1;else{b.runLoading=!1,b.runCount=b.runCount+1;var h=d.check,i=g.getVariablesFromResponse(d);b.initial_code_result.output=d.output,b.initial_code_result.plots=i.plots,h?(b.codeSuccess=!0,a.showAll||(f.$emit("screen-gold-received"),a.correct.play())):(b.codeSuccess=!1,a.incorrect.play(),void 0!=d.hint&&d.hint.length>0?b.answerHint=d.hint:b.answerHint=void 0)}};a.runCode=function(c){var d=c.editor.getSession().getValue();c.runLoading=!0,a.correct=k.load("sounds/correct.mp3"),a.incorrect=k.load("sounds/incorrect.mp3"),l.trackAnalyticsEvent("run-code",{mission:w,sequence:a.currentScreen[i].sequence}),b.checkCode(c.url,d).then(function(a){var b=a.task_type,d=a.task_id;v.pollTask(b,d,c,D)},function(a){c.runLoading=!1})},a.resetCode=function(c){c.resetLoading=!0,l.trackAnalyticsEvent("reset-code",{mission:w,sequence:a.currentScreen[i].sequence}),b.resetCode(c.url).then(function(a){c.resetLoading=!1,c.initial_code_result.output=a.output;var b=g.getVariablesFromResponse(a);c.initial_code_result.plots=b.plots,c.editor.setValue(a.code,-1),x(c.editor)},function(a){c.resetLoading=!1})},a.showBoard=function(){var b=a.mission.board_id;l.trackAnalyticsEvent("open-forum",{mission:w,sequence:a.currentScreen[i].sequence}),r.openBoardModal(b)};var E=function(){a.showAll=!0;for(var b=0;b<a.currentScreen.length;b++)if("code"==a.currentScreen[b].type){var c=g.getVariablesFromResponse(a.currentScreen[b].initial_code_result);a.currentScreen[b].initial_code_result.plots=c.plots,a.currentScreen[b].active=!1,a.currentScreen[b].runLoading=!1,a.currentScreen[b].codeSuccess=void 0,a.currentScreen[b].showNextMessage=!0,a.currentScreen[b].runCount=0,void 0!=a.currentScreen[b].initial_code_result&&1==a.currentScreen[b].initial_code_result.check?(a.currentScreen[b].codeSuccess=!0,a.currentScreen[b].showNextMessage=!1):a.showAll=!1}};a.setActive=function(b){for(var c=0;c<a.currentScreen.length;c++)a.currentScreen[c].active=!1;b.active=!0};var F=function(){b.mission(w).then(function(b){a.mission=b,l.trackAnalyticsEvent("started-mission",{sequence:a.mission.sequence}),a.currentScreen=b.current_screen,a.mission.progress=a.currentScreen.sequence,a.mission.progress>a.mission.total&&(a.mission.progress=a.mission.total),a.currentSequence=a.mission.current_sequence,E()},function(a){u.pop("error","Error loading mission",a.error,0)})};a.editorClass=function(a){return"code-editor"+a.sequence},a.$on("youtube.player.ended",function(b,c){l.trackAnalyticsEvent("video-ended",{mission:w,sequence:a.currentScreen[i].sequence})}),a.$on("youtube.player.ready",function(b,c){l.trackAnalyticsEvent("video-ready",{mission:w,sequence:a.currentScreen[i].sequence})}),a.$on("youtube.player.playing",function(b,c){l.trackAnalyticsEvent("video-playing",{mission:w,sequence:a.currentScreen[i].sequence})}),a.$on("youtube.player.paused",function(b,c){l.trackAnalyticsEvent("video-paused",{mission:w,sequence:a.currentScreen[i].sequence})}),a.$on("youtube.player.error",function(b,c){l.trackAnalyticsEvent("video-error",{mission:w,sequence:a.currentScreen[i].sequence})}),F()}]),function(){var a,b,c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}},g=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};b=function(){function a(){}return a.prototype.extend=function(a,b){var c,d;for(c in b)d=b[c],null==a[c]&&(a[c]=d);return a},a.prototype.isMobile=function(a){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a)},a.prototype.addEvent=function(a,b,c){return null!=a.addEventListener?a.addEventListener(b,c,!1):null!=a.attachEvent?a.attachEvent("on"+b,c):a[b]=c},a.prototype.removeEvent=function(a,b,c){return null!=a.removeEventListener?a.removeEventListener(b,c,!1):null!=a.detachEvent?a.detachEvent("on"+b,c):delete a[b]},a.prototype.innerHeight=function(){return"innerHeight"in window?window.innerHeight:document.documentElement.clientHeight},a}(),c=this.WeakMap||this.MozWeakMap||(c=function(){function a(){this.keys=[],this.values=[]}return a.prototype.get=function(a){var b,c,d,e,f;for(f=this.keys,b=d=0,e=f.length;e>d;b=++d)if(c=f[b],c===a)return this.values[b]},a.prototype.set=function(a,b){var c,d,e,f,g;for(g=this.keys,c=e=0,f=g.length;f>e;c=++e)if(d=g[c],d===a)return void(this.values[c]=b);return this.keys.push(a),this.values.push(b)},a}()),a=this.MutationObserver||this.WebkitMutationObserver||this.MozMutationObserver||(a=function(){function a(){"undefined"!=typeof console&&null!==console&&console.warn("MutationObserver is not supported by your browser."),"undefined"!=typeof console&&null!==console&&console.warn("WOW.js cannot detect dom mutations, please call .sync() after loading new content.")}return a.notSupported=!0,a.prototype.observe=function(){},a}()),d=this.getComputedStyle||function(a){return this.getPropertyValue=function(b){var c;return"float"===b&&(b="styleFloat"),e.test(b)&&b.replace(e,function(a,b){return b.toUpperCase()}),(null!=(c=a.currentStyle)?c[b]:void 0)||null},this},e=/(\-([a-z]){1})/g,this.WOW=function(){function e(a){null==a&&(a={}),this.scrollCallback=f(this.scrollCallback,this),this.scrollHandler=f(this.scrollHandler,this),this.start=f(this.start,this),this.scrolled=!0,this.config=this.util().extend(a,this.defaults),this.animationNameCache=new c}return e.prototype.defaults={boxClass:"wow",animateClass:"animated",offset:0,mobile:!0,live:!0},e.prototype.init=function(){var a;return this.element=window.document.documentElement,"interactive"===(a=document.readyState)||"complete"===a?this.start():this.util().addEvent(document,"DOMContentLoaded",this.start),this.finished=[]},e.prototype.start=function(){var b,c,d,e;if(this.stopped=!1,this.boxes=function(){var a,c,d,e;for(d=this.element.querySelectorAll("."+this.config.boxClass),e=[],a=0,c=d.length;c>a;a++)b=d[a],e.push(b);return e}.call(this),this.all=function(){var a,c,d,e;for(d=this.boxes,e=[],a=0,c=d.length;c>a;a++)b=d[a],e.push(b);return e}.call(this),this.boxes.length)if(this.disabled())this.resetStyle();else for(e=this.boxes,c=0,d=e.length;d>c;c++)b=e[c],this.applyStyle(b,!0);return this.disabled()||(this.util().addEvent(window,"scroll",this.scrollHandler),this.util().addEvent(window,"resize",this.scrollHandler),this.interval=setInterval(this.scrollCallback,50)),this.config.live?new a(function(a){return function(b){var c,d,e,f,g;for(g=[],e=0,f=b.length;f>e;e++)d=b[e],g.push(function(){var a,b,e,f;for(e=d.addedNodes||[],f=[],a=0,b=e.length;b>a;a++)c=e[a],f.push(this.doSync(c));return f}.call(a));return g}}(this)).observe(document.body,{childList:!0,subtree:!0}):void 0},e.prototype.stop=function(){return this.stopped=!0,this.util().removeEvent(window,"scroll",this.scrollHandler),this.util().removeEvent(window,"resize",this.scrollHandler),null!=this.interval?clearInterval(this.interval):void 0},e.prototype.sync=function(){return a.notSupported?this.doSync(this.element):void 0},e.prototype.doSync=function(a){var b,c,d,e,f;if(null==a&&(a=this.element),1===a.nodeType){for(a=a.parentNode||a,e=a.querySelectorAll("."+this.config.boxClass),f=[],c=0,d=e.length;d>c;c++)b=e[c],g.call(this.all,b)<0?(this.boxes.push(b),this.all.push(b),this.stopped||this.disabled()?this.resetStyle():this.applyStyle(b,!0),f.push(this.scrolled=!0)):f.push(void 0);return f}},e.prototype.show=function(a){return this.applyStyle(a),a.className=""+a.className+" "+this.config.animateClass},e.prototype.applyStyle=function(a,b){var c,d,e;return d=a.getAttribute("data-wow-duration"),c=a.getAttribute("data-wow-delay"),e=a.getAttribute("data-wow-iteration"),this.animate(function(f){return function(){return f.customStyle(a,b,d,c,e)}}(this))},e.prototype.animate=function(){return"requestAnimationFrame"in window?function(a){return window.requestAnimationFrame(a)}:function(a){return a()}}(),e.prototype.resetStyle=function(){var a,b,c,d,e;for(d=this.boxes,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.style.visibility="visible");return e},e.prototype.customStyle=function(a,b,c,d,e){return b&&this.cacheAnimationName(a),a.style.visibility=b?"hidden":"visible",c&&this.vendorSet(a.style,{animationDuration:c}),d&&this.vendorSet(a.style,{animationDelay:d}),e&&this.vendorSet(a.style,{animationIterationCount:e}),this.vendorSet(a.style,{animationName:b?"none":this.cachedAnimationName(a)}),a},e.prototype.vendors=["moz","webkit"],e.prototype.vendorSet=function(a,b){var c,d,e,f;f=[];for(c in b)d=b[c],a[""+c]=d,f.push(function(){var b,f,g,h;for(g=this.vendors,h=[],b=0,f=g.length;f>b;b++)e=g[b],h.push(a[""+e+c.charAt(0).toUpperCase()+c.substr(1)]=d);return h}.call(this));return f},e.prototype.vendorCSS=function(a,b){var c,e,f,g,h,i;for(e=d(a),c=e.getPropertyCSSValue(b),i=this.vendors,g=0,h=i.length;h>g;g++)f=i[g],c=c||e.getPropertyCSSValue("-"+f+"-"+b);return c},e.prototype.animationName=function(a){var b;try{b=this.vendorCSS(a,"animation-name").cssText}catch(c){b=d(a).getPropertyValue("animation-name")}return"none"===b?"":b},e.prototype.cacheAnimationName=function(a){return this.animationNameCache.set(a,this.animationName(a))},e.prototype.cachedAnimationName=function(a){return this.animationNameCache.get(a)},e.prototype.scrollHandler=function(){return this.scrolled=!0},e.prototype.scrollCallback=function(){var a;return!this.scrolled||(this.scrolled=!1,this.boxes=function(){var b,c,d,e;for(d=this.boxes,e=[],b=0,c=d.length;c>b;b++)a=d[b],a&&(this.isVisible(a)?this.show(a):e.push(a));return e}.call(this),this.boxes.length||this.config.live)?void 0:this.stop()},e.prototype.offsetTop=function(a){for(var b;void 0===a.offsetTop;)a=a.parentNode;for(b=a.offsetTop;a=a.offsetParent;)b+=a.offsetTop;return b},e.prototype.isVisible=function(a){var b,c,d,e,f;return c=a.getAttribute("data-wow-offset")||this.config.offset,f=window.pageYOffset,e=f+Math.min(this.element.clientHeight,this.util().innerHeight())-c,d=this.offsetTop(a),b=d+a.clientHeight,e>=d&&b>=f},e.prototype.util=function(){return null!=this._util?this._util:this._util=new b},e.prototype.disabled=function(){return!this.config.mobile&&this.util().isMobile(navigator.userAgent)},e}()}.call(this),$(window).load(function(){var a=new WOW({mobile:!1});a.init()}),angular.module("dsfrontendApp").directive("hoverClass",function(){return{restrict:"A",scope:{hoverClass:"@",removeClass:"@"},link:function(a,b){b.on("mouseenter",function(){b.addClass(a.hoverClass),b.removeClass(a.removeClass)}),b.on("mouseleave",function(){b.removeClass(a.hoverClass),b.addClass(a.removeClass)})}}}).directive("popoverHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"templates/popover-html-unsafe-popup.html"}}).directive("popoverHtmlUnsafeAnswerPopup",function(){return{restrict:"EA",replace:!0,scope:{title:"@",content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"templates/popover-html-unsafe-answer-popup.html"}}).directive("popoverHtmlUnsafeAnswer",["$tooltip",function(a){return a("popoverHtmlUnsafeAnswer","popover","click")}]).directive("popoverHtmlUnsafe",["$tooltip",function(a){return a("popoverHtmlUnsafe","popover","click")}]).directive("missionCard",function(){return{restrict:"E",scope:{mission:"=",goToMission:"="},templateUrl:"templates/mission-card.html"}}).directive("lessonCard",function(){return{restrict:"E",templateUrl:"templates/lesson-card.html"}}).directive("boardCard",function(){return{restrict:"E",templateUrl:"templates/board-card.html"}}).directive("postCard",function(){return{restrict:"E",templateUrl:"templates/post-card.html"}}).directive("boardsCard",function(){return{restrict:"E",templateUrl:"templates/boards-card.html"}}).directive("mathjax",function(){return{restrict:"E",link:function(a,b,c){var d=angular.element("<script type='math/tex'>").html(b.html());b.html(""),b.append(d),MathJax.Hub.Queue(["Reprocess",MathJax.Hub,b[0]])}}}).directive("dynamic",["$compile",function(a){return{restrict:"A",replace:!0,link:function(b,c,d){b.$watch(d.dynamic,function(d){c.html(d),a(c.contents())(b)})}}}]).directive("missionView",function(){return{restrict:"E",templateUrl:"templates/mission-view.html"}}).directive("nextMissionButton",function(){return{restrict:"E",templateUrl:"templates/next-mission-button.html"}}).directive("singleMissionView",function(){return{restrict:"E",templateUrl:"templates/single-mission-view.html"}}).directive("singleScreenNext",function(){return{restrict:"E",templateUrl:"templates/single-screen-next.html"}});