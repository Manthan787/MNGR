<div class="rightside">
    <div class="content">
        <div class="row">
            <div class="container">
                <div class="alert alert-danger" ng-show="error">{{ error }}</div>
                <div class="alert alert-success" ng-show="success">{{ success }}</div>
                <div align="center" ng-show="loading">
                    <img src="app/admin/img/loader.gif" height="45" width="45">
                </div>
                <div class="row">
                    <div class="col-md-2"></div>
                    <div class="col-md-8">
                        <div class="box">
                            <div class="box-title">
                                <h3>Create Test</h3>
                            </div>
                            <div class="box-body">
                                <form  class="form-horizontal" name="createTestForm" ng-controller="CreateTestController" ng-submit="createTest(createTestForm.$valid)" novalidate>
                                    <div class="form-group" ng-class="{'has-error':(submitted && createTestForm.name.$invalid) || (createTestForm.name.$invalid && createTestForm.name.$dirty)}">
                                        <label class="col-sm-2 control-label">Name</label>
                                        <div class="col-sm-10">
                                            <input type="text" name="name" class="form-control" ng-model="newTest.name" required>
                                            <p class="help-block" ng-if="(submitted && createTestForm.name.$invalid) || (createTestForm.name.$invalid && createTestForm.name.$dirty)">Name is required.</p>
                                        </div>
                                    </div>
                                    <div class="form-group" ng-class="{'has-error':(submitted && createTestForm.marks.$invalid) || (createTestForm.marks.$invalid && createTestForm.marks.$dirty)}">
                                        <label class="col-sm-2 control-label">Marks</label>
                                        <div class="col-sm-10">
                                            <input type="number" name="marks" class="form-control" ng-model="newTest.marks" required>
                                            <p class="help-block" ng-if="(submitted && createTestForm.marks.$error.required) || (createTestForm.marks.$error.required && createTestForm.marks.$dirty)">Marks is required.</p>
                                            <p class="help-block" ng-if="(submitted && createTestForm.marks.$error.number) || (createTestForm.marks.$error.number && createTestForm.marks.$dirty)">Enter a valid number.</p>
                                        </div>
                                    </div>
                                    <div class="form-group" ng-class="{'has-error' : (submitted && createTestForm.subject.$invalid) || (createTestForm.subject.$invalid && createTestForm.subject.$dirty)}">
                                        <label class="col-sm-2 control-label">Subject</label>
                                        <div class="col-sm-10">
                                            <select type="text" name="subject" class="form-control" ng-model="newTest.subject_id" ng-change="getChapters(newTest.subject_id)" required>
                                                <option value="">Select Subject</option>
                                                <option ng-repeat="subject in subjects" value="{{subject.id}}">{{ subject.name }} ({{subject.standard.division}})</option>
                                            </select>
                                            <p class="help-block" ng-if="(submitted && createTestForm.subject.$invalid) || (createTestForm.subject.$invalid && createTestForm.subject.$dirty)">This field is required.</p>
                                        </div>
                                    </div>
                                    <div class="form-group" ng-if="hasChapters" ng-class="{'has-error' : (submitted && createTestForm.chapters.$invalid) || (createTestForm.chapters.$invalid && createTestForm.chapters.$dirty)}">
                                        <label class="col-sm-2 control-label">Chapters</label>
                                        <div class="col-sm-10">
                                            <select type="text" name="chapters" class="form-control" ng-options="chapter.id as chapter.title for chapter in chapters" ng-model="newTest.chapters" required multiple ng-multiple="true">
                                            </select>
                                            <p class="help-block" ng-if="(submitted && createTestForm.chapters.$invalid) || (createTestForm.chapters.$invalid && createTestForm.chapters.$dirty)">This field is required.</p>
                                        </div>
                                    </div>
                                    <div class="form-group has-warning" ng-if="noChaptersError">
                                        <label class="col-sm-2 control-label">Warning</label>
                                        <div class="col-sm-10">
                                            <div class="alert alert-warning" align="center">The subject you selected doesn't have any chapters. Please add some chapters to this subject and try again later.</div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div align="center">
                                            <input type="submit" class="btn btn-success" value="Generate Test" ng-disabled="noChaptersError">
                                        </div>
                                    </div>
                                </form>
                                {{$scope.questions}}
                            </div>
                        </div>
                    </div>
                 </div>
            </div>
        </div>
    </div>
</div>
